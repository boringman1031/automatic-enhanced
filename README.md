# 自動化任務建立工具 (automatic)

這個專案透過 Node.js 腳本（index.js）將 Word 任務檔案轉成後台建立任務／知識卡所需的欄位資料，並搭配 Puppeteer 自動化操作頁面。

---

## ⚙️ 環境需求

* Node.js 18 或以上版本
* npm（已隨 Node.js 安裝提供）

---

## 📦 安裝

### 1️⃣ 安裝 Node.js（含 npm）

若終端機輸入 `npm -v` 顯示錯誤，代表你尚未安裝 Node.js。

在 Windows 終端機輸入以下指令打開 Node.js 官網並下載 **LTS 版本** 安裝檔：

```bash
start https://nodejs.org/
```

安裝過程請務必勾選 **「Add to PATH」**，安裝完成後重新打開終端機，輸入以下指令確認：

```bash
node -v
npm -v
```

能看到版本號即表示安裝成功。

### 2️⃣ （可選）安裝 Python + pip

如果之後要使用 Python 環境，可直接在終端輸入以下指令安裝：

```bash
winget install -e --id Python.Python.3.12
```

安裝完成後確認：

```bash
python --version
pip --version
```

### 3️⃣ 安裝專案依賴

進入專案目錄後執行：

```bash
npm install
```

## 📂 使用前請注意

1. **Word 檔要放的位置**：

   * 請將要處理的 Word 檔（`.docx` 格式）放到專案根目錄下的 `./docs/` 資料夾。
   * 範例：`./docs/第一題.docx`、`./docs/第二題.docx` …
2. **命名建議**：

   * 可以用「第一題」、「第二題」這樣的連號檔名，方便批次處理。
   * 也可以使用其他自訂檔名（例如：`./docs/我的任務.docx`）。
3. **⚠️ 特別注意：解答說明欄位**

   <img width="915" height="145" alt="image" src="[https://github.com/user-attachments/assets/4471eb04-be3d-4feb-8030-ccb64bdf5068](https://github.com/user-attachments/assets/4471eb04-be3d-4feb-8030-ccb64bdf5068)" />

   * 有時候 Word 轉換過來，前面的「1、2、3」編號不會完整保留，這是 Word 檔格式問題，不會每次都發生。
   * 請在輸出結果時多看一眼，若缺少編號可手動補上。

---

## 🚀 使用方式

以下指令會讀取 `./docs/第一題.docx`，並同時產生任務與知識卡資料：

```bash
npm run start-task -- --word ./docs/第一題.docx --mode=task+card
```

💡 `第一題.docx` 只是範例，請依實際需求更換檔名。

---

## 🧭 實際操作流程（一步一步）

> 只要依照終端機提示按 Enter，就能逐步完成。以下描述的是實際畫面與互動順序。

1. **開啟任務頁（建立任務）**

   * 終端機會提示你切到「任務頁」。
   * 按下 Enter 後，程式會**自動貼上**：任務名稱、線索文本（內容）、解答說明、整體鷹架提示1~3…等**輸入框**內容。

2. **切到卡片頁（創建卡片模式）**

   * 終端機會提示你切到卡片頁面，並逐張處理（最多 12 張：1-1 ~ 3-4）。
   * 每張卡片按下 Enter 後，會**自動貼上**：

     * 卡片名稱
     * 文字內容

3. **先按「搜尋現有圖片」**

   * 到卡片頁，請先點「搜尋現有圖片」開啟視窗，並**先手動選擇卡片類型**（若頁面需要）。
   * 視窗開啟後按 Enter，程式會把本張**卡片名稱**自動貼到搜尋框。
   * 你可以自行按「搜尋」或挑選圖片。

4. **（分支 A）若有找到合適圖片**

   * 仍在「搜尋現有圖片」視窗時，**直接按 Enter**，即可**跳過**原本應該進行的「上傳圖片」步驟，程式會**直接繼續到下一張卡片**。

5. **（分支 B）若沒有找到，改用上傳圖片**

   * 關閉搜尋視窗，點「上傳圖片」開啟上傳視窗。
   * 按 Enter 後，程式會在上傳視窗**自動貼上**：

     * 圖片名稱（取用卡片名稱）
     * 圖片描述（取用卡片文字內容第一行）
   * 其餘上傳與送出，請依頁面操作完成。

6. **重複步驟 2~5，直到 12 張卡片完成。**

7. **（手動）選擇正確答案 1/2/3**

   * 卡片完成後，請回到任務頁**手動勾選**「正確答案 1、2、3」。
   * 勾選完成後畫面才會出現 6 個輸入框（線索關鍵詞 ×3、鷹架提示 ×3）。
   * 目前版本**這 6 個欄位需手動填寫**。

> 小技巧：在 **loop 模式** 下，第一個檔案跑完後，下一個檔案的路徑可以直接**拖曳**到終端機再按 Enter，超省時。

---

## 🎯 執行情境

### 1️⃣ 單檔執行

若只需處理單一 Word 檔案：

```bash
npm run start-task -- --word ./docs/第一題.docx --mode=task+card
```

這樣程式只會處理 `./docs/第一題.docx`。

---

### 2️⃣ 多檔情境（loop 模式）

若需要連續處理多個 Word 檔：

#### 使用方式：

```bash
npm run start-task -- --word ./docs/第一題.docx --loop --mode=task+card
```

第一個檔案結束後，終端機會顯示：

```
📄 請輸入下一個 Word 檔路徑（直接 Enter 結束）：
```

<img width="1900" height="829" alt="image" src="[https://github.com/user-attachments/assets/a928dce3-5fa1-41b6-a1a7-456c7a5c9b89](https://github.com/user-attachments/assets/a928dce3-5fa1-41b6-a1a7-456c7a5c9b89)" />

👉 **此時你可以直接把檔案從檔案總管拖曳到終端機**，路徑會自動帶入，按 Enter 即可繼續。

* 例如拖曳 `第二題.docx` 到終端機，按 Enter → 程式會自動處理。
* 重複拖曳下一個檔案即可。
* 若沒有更多檔案，直接按 Enter 就會結束流程。

✅ 拖曳方式比手打路徑方便，特別適合多檔案處理。

---

## 🔧 常用參數

* `--word <路徑>`：指定 Word (.docx) 檔案位置。
* `--mode <task|card|task+card>`：輸出模式（預設 `task+card`）。
* `--loop`：連續處理多個檔案。
* `--close`：流程結束時關閉瀏覽器視窗。
* `--url <網址>`：自動開啟指定的「建立任務」頁面。

👉 若需調整欄位對應，可編輯 `mapping.json`。

---

## 📌 功能範圍與手動事項（很重要）

* ✅ 程式會**自動貼上**「所有文字輸入框」可填的內容：

  * 任務頁：任務名稱、線索文本（內容）、解答說明、整體鷹架提示 1~3（限 25 字）等。
  * 卡片頁：卡片名稱、文字內容。
  * 上傳圖片視窗：圖片名稱、圖片描述。
* 🖱️ **仍需手動的項目**：

  * 任務／卡片的**下拉選單**（如學科、類別、課綱等）。
  * 「搜尋現有圖片」中**選擇卡片類型、執行搜尋、挑選圖片**。
  * 圖片的實際**上傳與送出**（若你選擇走上傳流程）。
  * **正確答案 1/2/3** 的勾選；以及出現後的 6 個欄位（線索關鍵詞 ×3、鷹架提示 ×3）目前版本**需手動填寫**。
* 📝 「解答說明」的編號（1、2、3…）有時 Word 匯入會掉，請多檢查必要時手補。

---

## 📄 附註

* `docs/` 資料夾中的 Word 檔可作為測試輸入。
* 腳本會在終端機提示必要輸入，請依指示操作。
* 輸出結果會存放於 `./output/` 資料夾（或你設定的路徑）。

- `docs/` 資料夾中的 Word 檔可作為測試輸入。
- 腳本會在終端機提示必要輸入，請依指示操作。
- 輸出結果會存放於 `./output/` 資料夾（或你設定的路徑）。
